<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>TOBI SignalServer: /home/breidi/Dropbox/signalserver/hardware/data_packet.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>/home/breidi/Dropbox/signalserver/hardware/data_packet.h</h1><a href="data__packet_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00014"></a>00014 <span class="preprocessor">#ifndef DATAPACKET_H</span>
<a name="l00015"></a>00015 <span class="preprocessor"></span><span class="preprocessor">#define DATAPACKET_H</span>
<a name="l00016"></a>00016 <span class="preprocessor"></span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;map&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &lt;stdexcept&gt;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;stdint.h&quot;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;../defines.h&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;<a class="code" href="raw__mem_8h.html" title="raw_mem holds memory regions containing a raw representation of a datapacket">raw_mem.h</a>&quot;</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="keyword">using namespace </span>std;
<a name="l00027"></a>00027 
<a name="l00042"></a><a class="code" href="class_data_packet.html">00042</a> <span class="keyword">class </span><a class="code" href="class_data_packet.html" title="A Class to manage the DataPacket to be distributed over network.">DataPacket</a>
<a name="l00043"></a>00043 {
<a name="l00044"></a>00044   <span class="keyword">public</span>:
<a name="l00048"></a><a class="code" href="class_data_packet.html#a2790f5d5d053c3cd4e15792c6a57bed9">00048</a>     <a class="code" href="class_data_packet.html#a2790f5d5d053c3cd4e15792c6a57bed9" title="Default constructor -- building an empty DataPacket.">DataPacket</a>()
<a name="l00049"></a>00049     : flags(0), packet_nr(0), nr_signal_types(0)    {  }
<a name="l00050"></a>00050 
<a name="l00061"></a>00061     <a class="code" href="class_data_packet.html#a2790f5d5d053c3cd4e15792c6a57bed9" title="Default constructor -- building an empty DataPacket.">DataPacket</a>(<span class="keywordtype">void</span>* mem);
<a name="l00062"></a>00062 
<a name="l00070"></a><a class="code" href="class_data_packet.html#a6865aaea072c8af4caf7e4cb6baa0155">00070</a>     <span class="keyword">virtual</span> <a class="code" href="class_data_packet.html#a6865aaea072c8af4caf7e4cb6baa0155" title="Destructor.">~DataPacket</a>()
<a name="l00071"></a>00071     {
<a name="l00072"></a>00072       <span class="keywordflow">for</span>(map&lt;uint32_t, RawMem*&gt;::iterator it(raw_map.begin());
<a name="l00073"></a>00073           it != raw_map.end(); it++)
<a name="l00074"></a>00074         <span class="keyword">delete</span>(it-&gt;second);
<a name="l00075"></a>00075     }
<a name="l00080"></a><a class="code" href="class_data_packet.html#a0419e5f0113aad80d8c92f59bf990c26">00080</a>     <a class="code" href="class_data_packet.html#a2790f5d5d053c3cd4e15792c6a57bed9" title="Default constructor -- building an empty DataPacket.">DataPacket</a>(<span class="keyword">const</span> <a class="code" href="class_data_packet.html" title="A Class to manage the DataPacket to be distributed over network.">DataPacket</a> &amp;src)
<a name="l00081"></a>00081     {
<a name="l00082"></a>00082       sample_nr = src.sample_nr;
<a name="l00083"></a>00083       flags = src.flags;
<a name="l00084"></a>00084       packet_nr = src.packet_nr;
<a name="l00085"></a>00085       nr_signal_types = src.nr_signal_types;
<a name="l00086"></a>00086 
<a name="l00087"></a>00087       nr_blocks = src.nr_blocks;
<a name="l00088"></a>00088       nr_values = src.nr_values;
<a name="l00089"></a>00089       data = src.data;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091       map&lt;uint32_t, RawMem*&gt; raw_map;
<a name="l00092"></a>00092     }
<a name="l00096"></a>00096     <span class="keywordtype">void</span> <a class="code" href="class_data_packet.html#a36f3ab573fdeff022c6a5742795fc552" title="Resets the whole DataPacket (samples are deleted).">reset</a>();
<a name="l00100"></a>00100     <span class="keywordtype">void</span> <a class="code" href="class_data_packet.html#ada10e1ebb83a49faeca732765793cfa2" title="Increase the static sample number by one.">incSampleNr</a>();
<a name="l00116"></a>00116     <span class="keywordtype">void</span> <a class="code" href="class_data_packet.html#ab83c192471bb4d70cd21653adcc7da7f" title="Insert data (only one signal type) from a hardware device into the DataPacket (will...">insertDataBlock</a>(vector&lt;double&gt; v, uint32_t signal_flag, uint16_t blocks);
<a name="l00120"></a>00120     <span class="keywordtype">void</span> <a class="code" href="class_data_packet.html#a1b2a26a56f1a1a414fdbf20c6b8aff8f" title="Set the packet number (can differ from the samplenumber -- e.g. if sending with different...">setPacketNr</a>(uint64_t);
<a name="l00125"></a>00125     <span class="keywordtype">bool</span> <a class="code" href="class_data_packet.html#a8fed63bfc2f0903b49d88805368d2161" title="Check, if a flag is already set.">hasFlag</a>(uint32_t f);
<a name="l00131"></a>00131     uint8_t <a class="code" href="class_data_packet.html#ad86138bd32d1dd9b44fda5b830b6cd6a" title="Get the number of signal types stored in the DataPacket.">getNrOfSignalTypes</a>();
<a name="l00137"></a>00137     uint32_t <a class="code" href="class_data_packet.html#ab4bd49f2f36a2a15bc37235f388c33d1" title="Get the flags (including packetversion) of the DataPacket.">getFlags</a>();
<a name="l00142"></a>00142     uint64_t <a class="code" href="class_data_packet.html#a74e9c0a441f1bb05d1134cc1a10f2cb6" title="Get the sample number of the DataPacket.">getSampleNr</a>();
<a name="l00147"></a>00147     vector&lt;uint16_t&gt; <a class="code" href="class_data_packet.html#a73d518fa486ca53a334a061187063be7" title="Get a vector containing the blocksizes for every signal type.">getNrOfBlocks</a>();
<a name="l00152"></a>00152     vector&lt;uint16_t&gt; <a class="code" href="class_data_packet.html#a42a952fa11cc5247ce65e8a124eddcac" title="Get a vector containing the number of values (NOT channels!) for every signal type...">getNrOfValues</a>();
<a name="l00158"></a>00158     vector&lt;double&gt; <a class="code" href="class_data_packet.html#ae12c2a5fae637439431ddd66376ff797" title="Get all samples stored in the DataPacket as a vector.">getData</a>();
<a name="l00166"></a>00166     vector&lt;double&gt; <a class="code" href="class_data_packet.html#a4342e5412615ed2d09990b557bdb700a" title="Get a vector containing all samples for a specific signal type.">getSingleDataBlock</a>(uint32_t flag);
<a name="l00167"></a>00167 
<a name="l00176"></a>00176     <span class="keywordtype">void</span>* <a class="code" href="class_data_packet.html#a6d05054482f9844487d5253a1b903a1e" title="Get a pointer to a memory region, containing the raw representation of the DataPacket...">getRaw</a>();
<a name="l00181"></a>00181     uint16_t <a class="code" href="class_data_packet.html#a20f62ad94659c0f7f2faf143084764e5" title="Get the size (in bytes) of the raw memory region holding the raw DataPacket.">getRawMemorySize</a>();
<a name="l00182"></a>00182 
<a name="l00183"></a>00183   <span class="keyword">private</span>:
<a name="l00188"></a>00188     uint16_t calcNrOfSignalTypes(uint32_t f);
<a name="l00193"></a>00193     <span class="keywordtype">bool</span> flagsOK();
<a name="l00198"></a>00198     <span class="keywordtype">void</span> setFlag(uint32_t flag);
<a name="l00204"></a>00204     uint16_t getDataPos(uint32_t flag);
<a name="l00210"></a>00210     uint16_t getOffset(uint16_t pos);
<a name="l00211"></a>00211 
<a name="l00212"></a>00212   <span class="keyword">private</span>:
<a name="l00217"></a>00217     <span class="keyword">static</span> uint64_t  sample_nr;
<a name="l00218"></a>00218 
<a name="l00223"></a>00223     uint32_t  flags;
<a name="l00224"></a>00224     uint64_t  packet_nr;        
<a name="l00225"></a>00225     uint16_t   nr_signal_types;   
<a name="l00226"></a>00226 
<a name="l00227"></a>00227     vector&lt;uint16_t&gt;  nr_blocks;  
<a name="l00228"></a>00228     vector&lt;uint16_t&gt;  nr_values;  
<a name="l00229"></a>00229     vector&lt;double&gt; data;  
<a name="l00230"></a>00230 
<a name="l00231"></a>00231     map&lt;uint32_t, RawMem*&gt; raw_map; 
<a name="l00232"></a>00232 };
<a name="l00233"></a>00233 
<a name="l00234"></a>00234 <span class="preprocessor">#endif // DATAPACKET_H</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Thu Nov 12 16:55:10 2009 for TOBI SignalServer by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
